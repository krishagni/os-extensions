#macro(getMessage $code)$messageSource.getMessage($code, null, $locale)#end

<form>
  <view>
    <name>CollectionProtocol</name>
    <caption>#getMessage("cp")</caption>
    <table>CATISSUE_COLLECTION_PROTOCOL</table>
    <activeCondition>ACTIVITY_STATUS != 'Disabled'</activeCondition>
    <row>
      <numberField>
        <name>id</name>
        <udn>id</udn>
        <caption>#getMessage("cp_identifier")</caption>
        <column>IDENTIFIER</column>
        <recordUrl>#/cps/{{$value}}/overview</recordUrl>
      </numberField>
    </row>
    <row>
      <dropDown>
        <name>shortTitle</name>
        <udn>shortTitle</udn>
        <caption>#getMessage("cp_short_title")</caption>
        <column>SHORT_TITLE</column>
        <recordUrl>#/object-state-params-resolver?stateName=cp-detail.overview&amp;objectName=cp&amp;key=shortTitle&amp;value={{$value}}</recordUrl>
        <options>
          <sql>select distinct SHORT_TITLE from CATISSUE_COLLECTION_PROTOCOL where activity_status != 'Disabled'</sql>
        </options>
      </dropDown>
    </row>
    <row>
      <subForm>
        <name>cpSites</name>
        <udn>cpSites</udn>
        <caption>#getMessage("cp_sites")</caption>
        <table>CATISSUE_SITE_CP</table>
        <foreignKey>COLLECTION_PROTOCOL_ID</foreignKey>
        <parentKey>IDENTIFIER</parentKey>
        <row>
          <numberField>
            <name>siteId</name>
            <udn>siteId</udn>
            <caption>#getMessage("cp_sites_id")</caption>
            <column>SITE_ID</column>
            <recordUrl>#/object-state-params-resolver?stateName=site-detail.overview&amp;objectName=site&amp;key=id&amp;value={{$value}}</recordUrl>
          </numberField>
        </row>
      </subForm>
    </row>
  </view>
</form>
